<Task>
  <Tools Name="Combine Templates">
    <Tool Name="Allocation3tranches">
      <Actions>
        <Action ActionCode="OpeningBalance_A" ActionDisplayName="#{债券名称}#开始本金" FunctionName="RunManagedMethodByPath" SequenceNo="71">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningInvestedAmount_A" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_A" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Interest_Due_A" ActionDisplayName="#{债券名称}#应付利息" FunctionName="RunManagedMethodByPath" SequenceNo="72">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_CurrentPeriodInterest_A" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Interest_Due_A" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Principal_Due_A" ActionDisplayName="优先A档应付本金" FunctionName="RunManagedMethodByPath" SequenceNo="73">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_AllocationAmount_A" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Principal_Due_A" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="OpeningBalance_B" ActionDisplayName="#{actioncode2}#开始本金" FunctionName="RunManagedMethodByPath" SequenceNo="74">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningInvestedAmount_B" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_B" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Interest_Due_B" ActionDisplayName="优先B档应付利息" FunctionName="RunManagedMethodByPath" SequenceNo="75">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_CurrentPeriodInterest_B" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Interest_Due_B" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Principal_Due_B" ActionDisplayName="优先B档应付本金" FunctionName="RunManagedMethodByPath" SequenceNo="76">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_AllocationAmount_B" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Principal_Due_B" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="OpeningBalance_EquityClass" ActionDisplayName="次级开始本金" FunctionName="RunManagedMethodByPath" SequenceNo="77">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningInvestedAmount_EquityClass" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_EquityClass" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Principal_Due_EquityClass" ActionDisplayName="次级应付本金" FunctionName="RunManagedMethodByPath" SequenceNo="79">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_AllocationAmount_EquityClass" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Principal_Due_EquityClass" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Interest_Paid_A" ActionDisplayName="A级债券利息分配" FunctionName="RunManagedMethodByPath" SequenceNo="100">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Interest_Paid_A" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Principal_Paid_A" ActionDisplayName="A级债券本金分配" FunctionName="RunManagedMethodByPath" SequenceNo="101">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Principal_Paid_A" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Interest_Paid_B" ActionDisplayName="B级债券利息分配" FunctionName="RunManagedMethodByPath" SequenceNo="102">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Interest_Paid_B" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Principal_Paid_B" ActionDisplayName="B级债券本金分配" FunctionName="RunManagedMethodByPath" SequenceNo="103">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Principal_Paid_B" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Interest_Paid_EquityClass" ActionDisplayName="次级利息分配" FunctionName="RunManagedMethodByPath" SequenceNo="104">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Interest_Paid_EquityClass" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Principal_Paid_EquityClass" ActionDisplayName="次级本金分配" FunctionName="RunManagedMethodByPath" SequenceNo="105">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Principal_Paid_EquityClass" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Payment_Level1" ActionDisplayName="一级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="110">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level1" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="1" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level2" ActionDisplayName="二级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="111">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level2" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="2" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level3" ActionDisplayName="三级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="112">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level3" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="3" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level4" ActionDisplayName="四级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="113">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level4" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="4" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level5" ActionDisplayName="五级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="114">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level5" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="5" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level6" ActionDisplayName="六级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="115">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level6" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="6" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="ClosingBalance_A" ActionDisplayName="优先A档结束本金" FunctionName="RunManagedMethodByPath" SequenceNo="120">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingInvestedAmount_A" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_A" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="ClosingBalance_B" ActionDisplayName="优先B档结束本金" FunctionName="RunManagedMethodByPath" SequenceNo="121">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingInvestedAmount_B" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_B" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="ClosingBalance_EquityClass" ActionDisplayName="次级结束本金" FunctionName="RunManagedMethodByPath" SequenceNo="122">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingInvestedAmount_EquityClass" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_EquityClass" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
      </Actions>
      <Methods>
        <main>
          <Parameters>
            <Parameter  Name="InitialInvestedAmount" SessionParameterName="InitialInvestedAmount_A" Value="" DataType="double" Usage="CashFlow"/>
            <Parameter  Name="PreClosingInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="ClosingBalance_A">
                <Position>Math.Max(CurrentPosition-1,0)</Position>
              </Field>
            </Parameter>
          </Parameters>
          <Query name="EC_OpeningInvestedAmount_A" >
            if (CurrentPosition == 0 )
            {
            return InitialInvestedAmount;
            }
            else
            {
            return PreClosingInvestedAmount;
            };
          </Query>
          <Presentation />
        </main>
        <main>
          <Parameters>
            <Parameter  Name="InitialInvestedAmount" SessionParameterName="InitialInvestedAmount_B" Value="" DataType="double" Usage="CashFlow"/>
            <Parameter  Name="PreClosingInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="ClosingBalance_B">
                <Position>Math.Max(CurrentPosition-1,0)</Position>
              </Field>
            </Parameter>
          </Parameters>
          <Query name="EC_OpeningInvestedAmount_B" >
            if (CurrentPosition == 0 )
            {
            return InitialInvestedAmount;
            }
            else
            {
            return PreClosingInvestedAmount;
            };
          </Query>
          <Presentation />
        </main>
        <main>
          <Parameters>
            <Parameter  Name="InitialInvestedAmount" SessionParameterName="InitialInvestedAmount_C" Value="" DataType="double" Usage="CashFlow"/>
            <Parameter  Name="PreClosingInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="ClosingBalance_EquityClass">
                <Position>Math.Max(CurrentPosition-1,0)</Position>
              </Field>
            </Parameter>
          </Parameters>
          <Query name="EC_OpeningInvestedAmount_EquityClass" >
            if (CurrentPosition == 0 )
            {
            return InitialInvestedAmount;
            }
            else
            {
            return PreClosingInvestedAmount;
            };
          </Query>
          <Presentation />
        </main>
        <main>
          <Parameters>
            <Parameter  Name="Income_TotalAvailable" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="Income_TotalAvailable">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
            <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="OpeningBalance_A">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
          </Parameters>
          <Query name="EC_AllocationAmount_A" >

            return Math.Min(OpeningInvestedAmount, Income_TotalAvailable);

          </Query>
          <Presentation/>
        </main>
        <main>
          <Parameters>
            <Parameter  Name="Income_TotalAvailable" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="Income_TotalAvailable">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
            <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="OpeningBalance_B">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
          </Parameters>
          <Query name="EC_AllocationAmount_B" >

            return Math.Min(OpeningInvestedAmount, Income_TotalAvailable);

          </Query>
          <Presentation/>
        </main>
        <main>
          <Parameters>
            <Parameter  Name="Income_TotalAvailable" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="Income_TotalAvailable">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
            <Parameter  Name="OpeningBalance_A" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="OpeningBalance_A">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
            <Parameter  Name="OpeningBalance_B" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="OpeningBalance_B">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
            <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="OpeningBalance_EquityClass">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
          </Parameters>
          <Query name="EC_AllocationAmount_EquityClass" >
            if (OpeningBalance_A == 0 &amp;&amp; OpeningBalance_B == 0 )
            {
            return Income_TotalAvailable;
            }
            else return Math.Min(OpeningInvestedAmount, Income_TotalAvailable);
          </Query>
          <Presentation/>
        </main>
        <main>
          <Parameters>
            <Parameter  Name="InterestRate" SessionParameterName="InterestRate" Value="" DataType="double" Usage="CashFlow" />
            <Parameter  Name="BaseNoteMargin" SessionParameterName="BaseNoteMargin_A" Value="" DataType="double" Usage="CashFlow" />
            <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="OpeningBalance_A">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
            <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
          </Parameters>
          <Query name="EC_CurrentPeriodInterest_A" >
            if (TopUpPeriod == 0)
            {
            return OpeningInvestedAmount * (InterestRate+BaseNoteMargin) / 12;
            }
            else if (TopUpPeriod == 1 &amp;&amp; ((CurrentPosition + 1) % 3 == 0))
            {
            return OpeningInvestedAmount * (InterestRate+BaseNoteMargin) * 3 / 12;
            }
            else
            {
            return 0.0;
            }

          </Query>
          <Presentation/>
        </main>

        <main>
          <Parameters>
            <Parameter  Name="InterestRate" SessionParameterName="InterestRate" Value="" DataType="double" Usage="CashFlow" />
            <Parameter  Name="BaseNoteMargin" SessionParameterName="BaseNoteMargin_B" Value="" DataType="double" Usage="CashFlow" />
            <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="OpeningBalance_B">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
            <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
          </Parameters>
          <Query name="EC_CurrentPeriodInterest_B" >
            if (TopUpPeriod == 0)
            {
            return OpeningInvestedAmount * (InterestRate+BaseNoteMargin) / 12;
            }
            else if (TopUpPeriod == 1 &amp;&amp; ((CurrentPosition + 1) % 3 == 0))
            {
            return OpeningInvestedAmount * (InterestRate+BaseNoteMargin) * 3 / 12;
            }
            else
            {
            return 0.0;
            }
          </Query>
          <Presentation/>
        </main>

        <main>
          <Parameters>
          </Parameters>
          <Query name="EC_CurrentPeriodInterest_EquityClass" >
            return 0.0;
          </Query>
          <Presentation/>
        </main>
        <main>
          <Parameters>
            <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="OpeningBalance_A">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
            <Parameter  Name="AllocationAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="Principal_Paid_A">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
          </Parameters>
          <Query name="EC_ClosingInvestedAmount_A" >
            return Math.Max(OpeningInvestedAmount - AllocationAmount,0);
          </Query>
          <Presentation/>
        </main>
        <main>
          <Parameters>
            <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="OpeningBalance_B">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
            <Parameter  Name="AllocationAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="Principal_Paid_B">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
          </Parameters>
          <Query name="EC_ClosingInvestedAmount_B" >
            return Math.Max(OpeningInvestedAmount - AllocationAmount,0);
          </Query>
          <Presentation/>
        </main>
        <main>
          <Parameters>
            <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="OpeningBalance_EquityClass">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
            <Parameter  Name="AllocationAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
              <Field Name="Principal_Paid_EquityClass">
                <Position>CurrentPosition</Position>
              </Field>
            </Parameter>
          </Parameters>
          <Query name="EC_ClosingInvestedAmount_EquityClass" >
            return Math.Max(OpeningInvestedAmount - AllocationAmount,0);
          </Query>
          <Presentation/>
        </main>
      </Methods>
    </Tool>
    <Tool Name="Allocation4tranches">
      <Actions>
        <Action ActionCode="OpeningBalance_A" ActionDisplayName="优先A档开始本金" FunctionName="RunManagedMethodByPath" SequenceNo="71">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningInvestedAmount_A" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_A" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Interest_Due_A" ActionDisplayName="优先A档应付利息" FunctionName="RunManagedMethodByPath" SequenceNo="72">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_CurrentPeriodInterest_A" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Interest_Due_A" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Principal_Due_A" ActionDisplayName="优先A档应付本金" FunctionName="RunManagedMethodByPath" SequenceNo="73">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_AllocationAmount_A" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Principal_Due_A" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="OpeningBalance_B" ActionDisplayName="优先B档开始本金" FunctionName="RunManagedMethodByPath" SequenceNo="74">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningInvestedAmount_B" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_B" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Interest_Due_B" ActionDisplayName="优先B档应付利息" FunctionName="RunManagedMethodByPath" SequenceNo="75">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_CurrentPeriodInterest_B" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Interest_Due_B" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Principal_Due_B" ActionDisplayName="优先B档应付本金" FunctionName="RunManagedMethodByPath" SequenceNo="76">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_AllocationAmount_B" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Principal_Due_B" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="OpeningBalance_C" ActionDisplayName="优先C档开始本金" FunctionName="RunManagedMethodByPath" SequenceNo="77">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningInvestedAmount_C" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_C" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Interest_Due_C" ActionDisplayName="优先C档应付利息" FunctionName="RunManagedMethodByPath" SequenceNo="78">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_CurrentPeriodInterest_C" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Interest_Due_C" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Principal_Due_C" ActionDisplayName="优先C档应付本金" FunctionName="RunManagedMethodByPath" SequenceNo="79">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_AllocationAmount_C" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Principal_Due_C" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="OpeningBalance_EquityClass" ActionDisplayName="次级债券开始本金" FunctionName="RunManagedMethodByPath" SequenceNo="80">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningInvestedAmount_EquityClass" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_EquityClass" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Principal_Due_EquityClass" ActionDisplayName="次级债券应付本金" FunctionName="RunManagedMethodByPath" SequenceNo="82">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_AllocationAmount_EquityClass" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Principal_Due_EquityClass" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Interest_Paid_A" ActionDisplayName="A级债券利息分配" FunctionName="RunManagedMethodByPath" SequenceNo="100">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Interest_Paid_A" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Principal_Paid_A" ActionDisplayName="A级债券本金分配" FunctionName="RunManagedMethodByPath" SequenceNo="101">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Principal_Paid_A" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Interest_Paid_B" ActionDisplayName="B级债券利息分配" FunctionName="RunManagedMethodByPath" SequenceNo="102">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Interest_Paid_B" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Principal_Paid_B" ActionDisplayName="B级债券本金分配" FunctionName="RunManagedMethodByPath" SequenceNo="103">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Principal_Paid_B" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Interest_Paid_C" ActionDisplayName="C级债券利息分配" FunctionName="RunManagedMethodByPath" SequenceNo="104">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Interest_Paid_C" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Principal_Paid_C" ActionDisplayName="C级债券本金分配" FunctionName="RunManagedMethodByPath" SequenceNo="105">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Principal_Paid_C" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Interest_Paid_EquityClass" ActionDisplayName="次级利息分配" FunctionName="RunManagedMethodByPath" SequenceNo="106">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Interest_Paid_EquityClass" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Principal_Paid_EquityClass" ActionDisplayName="次级本金分配" FunctionName="RunManagedMethodByPath" SequenceNo="107">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="CreateCashFlow" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Principal_Paid_EquityClass" SessionParameterName="" Name="CashFlowName" />
        </Action>
        <Action ActionCode="Payment_Level1" ActionDisplayName="一级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="110">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level1" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="1" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level2" ActionDisplayName="二级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="111">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level2" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="2" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level3" ActionDisplayName="三级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="112">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level3" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="3" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level4" ActionDisplayName="四级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="113">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level4" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="4" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level5" ActionDisplayName="五级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="114">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level5" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="5" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level6" ActionDisplayName="六级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="115">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level6" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="6" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level7" ActionDisplayName="七级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="116">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level7" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="7" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="Payment_Level8" ActionDisplayName="八级偿付金额" FunctionName="RunManagedMethodByPath" SequenceNo="117">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\AddIn.CashflowScript.dll" DataType="String" Usage="Task" />
          <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfall" DataType="String" Usage="Task" />
          <Parameter Name="MethodName" SessionParameterName="" Value="RunWaterfall_UnifiedIncome" DataType="String" Usage="Task" />
          <Parameter Usage="" DataType="Int16" Value="0" SessionParameterName="CurrentPosition" Name="CurrentPosition" />
          <Parameter Usage="" DataType="String" Value="Payment_Level8" SessionParameterName="" Name="CashFlowName" />
          <Parameter Usage="" DataType="Int16" Value="8" SessionParameterName="" Name="Level" />
          <Parameter Usage="" DataType="String" Value="" SessionParameterName="CalculationSequence" Name="CalculationSequence" />
        </Action>
        <Action ActionCode="ClosingBalance_A" ActionDisplayName="优先A档结束本金" FunctionName="RunManagedMethodByPath" SequenceNo="120">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingInvestedAmount_A" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_A" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="ClosingBalance_B" ActionDisplayName="优先B档结束本金" FunctionName="RunManagedMethodByPath" SequenceNo="121">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingInvestedAmount_B" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_B" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="ClosingBalance_C" ActionDisplayName="优先C档结束本金" FunctionName="RunManagedMethodByPath" SequenceNo="122">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingInvestedAmount_C" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_C" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="ClosingBalance_EquityClass" ActionDisplayName="次级结束本金" FunctionName="RunManagedMethodByPath" SequenceNo="123">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingInvestedAmount_EquityClass" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_EquityClass" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
      </Actions>
      <Methods>
          <main>
            <Parameters>
              <Parameter  Name="InitialInvestedAmount" SessionParameterName="InitialInvestedAmount_A" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="PreClosingInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_A">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_OpeningInvestedAmount_A" >
              if (CurrentPosition == 0 )
              {
              return InitialInvestedAmount;
              }
              else
              {
              return PreClosingInvestedAmount;
              };
            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter  Name="InitialInvestedAmount" SessionParameterName="InitialInvestedAmount_B" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="PreClosingInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_B">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_OpeningInvestedAmount_B" >
              if (CurrentPosition == 0 )
              {
              return InitialInvestedAmount;
              }
              else
              {
              return PreClosingInvestedAmount;
              };
            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter  Name="InitialInvestedAmount" SessionParameterName="InitialInvestedAmount_C" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="PreClosingInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_C">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_OpeningInvestedAmount_C" >
              if (CurrentPosition == 0 )
              {
              return InitialInvestedAmount;
              }
              else
              {
              return PreClosingInvestedAmount;
              };
            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter  Name="InitialInvestedAmount" SessionParameterName="InitialInvestedAmount_D" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="PreClosingInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_EquityClass">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_OpeningInvestedAmount_EquityClass" >
              if (CurrentPosition == 0 )
              {
              return InitialInvestedAmount;
              }
              else
              {
              return PreClosingInvestedAmount;
              };
            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter  Name="Income_TotalAvailable" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Income_TotalAvailable">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_A">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_AllocationAmount_A" >

              return Math.Min(OpeningInvestedAmount, Income_TotalAvailable);

            </Query>
            <Presentation/>
          </main>
          <main>
            <Parameters>
              <Parameter  Name="Income_TotalAvailable" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Income_TotalAvailable">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_B">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_AllocationAmount_B" >

              return Math.Min(OpeningInvestedAmount, Income_TotalAvailable);

            </Query>
            <Presentation/>
          </main>
          <main>
            <Parameters>
              <Parameter  Name="Income_TotalAvailable" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Income_TotalAvailable">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_C">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_AllocationAmount_C" >

              return Math.Min(OpeningInvestedAmount, Income_TotalAvailable);

            </Query>
            <Presentation/>
          </main>
          <main>
            <Parameters>
              <Parameter  Name="Income_TotalAvailable" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Income_TotalAvailable">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="OpeningBalance_A" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_A">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="OpeningBalance_B" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_B">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="OpeningBalance_C" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_C">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_EquityClass">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_AllocationAmount_EquityClass" >
              if (OpeningBalance_A == 0 &amp;&amp; OpeningBalance_B == 0 &amp;&amp; OpeningBalance_C == 0 )
              {
              return Income_TotalAvailable;
              }
              else return Math.Min(OpeningInvestedAmount, Income_TotalAvailable);
            </Query>
            <Presentation/>
          </main>
          <main>
            <Parameters>
              <Parameter  Name="InterestRate" SessionParameterName="InterestRate" Value="" DataType="double" Usage="CashFlow" />
              <Parameter  Name="BaseNoteMargin" SessionParameterName="BaseNoteMargin_A" Value="" DataType="double" Usage="CashFlow" />
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_A">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_CurrentPeriodInterest_A" >
              if (TopUpPeriod == 0)
              {
              return OpeningInvestedAmount * (InterestRate+BaseNoteMargin) / 12;
              }
              else if (TopUpPeriod == 1 &amp;&amp; ((CurrentPosition + 1) % 3 == 0))
              {
              return OpeningInvestedAmount * (InterestRate+BaseNoteMargin) * 3 / 12;
              }
              else
              {
              return 0.0;
              }

            </Query>
            <Presentation/>
          </main>

          <main>
            <Parameters>
              <Parameter  Name="InterestRate" SessionParameterName="InterestRate" Value="" DataType="double" Usage="CashFlow" />
              <Parameter  Name="BaseNoteMargin" SessionParameterName="BaseNoteMargin_B" Value="" DataType="double" Usage="CashFlow" />
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_B">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_CurrentPeriodInterest_B" >
              if (TopUpPeriod == 0)
              {
              return OpeningInvestedAmount * (InterestRate+BaseNoteMargin) / 12;
              }
              else if (TopUpPeriod == 1 &amp;&amp; ((CurrentPosition + 1) % 3 == 0))
              {
              return OpeningInvestedAmount * (InterestRate+BaseNoteMargin) * 3 / 12;
              }
              else
              {
              return 0.0;
              }
            </Query>
            <Presentation/>
          </main>

          <main>
            <Parameters>
              <Parameter  Name="InterestRate" SessionParameterName="InterestRate" Value="" DataType="double" Usage="CashFlow" />
              <Parameter  Name="BaseNoteMargin" SessionParameterName="BaseNoteMargin_C" Value="" DataType="double" Usage="CashFlow" />
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_C">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_CurrentPeriodInterest_C" >
              if (TopUpPeriod == 0)
              {
              return OpeningInvestedAmount * (InterestRate+BaseNoteMargin) / 12;
              }
              else if (TopUpPeriod == 1 &amp;&amp; ((CurrentPosition + 1) % 3 == 0))
              {
              return OpeningInvestedAmount * (InterestRate+BaseNoteMargin) * 3 / 12;
              }
              else
              {
              return 0.0;
              }
            </Query>
            <Presentation/>
          </main>
          <main>
            <Parameters>
            </Parameters>
            <Query name="EC_CurrentPeriodInterest_EquityClass" >
              return 0.0;
            </Query>
            <Presentation/>
          </main>
          <main>
            <Parameters>
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_A">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="AllocationAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Principal_Paid_A">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_ClosingInvestedAmount_A" >
              return Math.Max(OpeningInvestedAmount - AllocationAmount,0);
            </Query>
            <Presentation/>
          </main>
          <main>
            <Parameters>
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_B">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="AllocationAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Principal_Paid_B">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_ClosingInvestedAmount_B" >
              return Math.Max(OpeningInvestedAmount - AllocationAmount,0);
            </Query>
            <Presentation/>
          </main>
          <main>
            <Parameters>
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_C">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="AllocationAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Principal_Paid_C">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_ClosingInvestedAmount_C" >
              return Math.Max(OpeningInvestedAmount - AllocationAmount,0);
            </Query>
            <Presentation/>
          </main>
          <main>
            <Parameters>
              <Parameter  Name="OpeningInvestedAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_EquityClass">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter  Name="AllocationAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Principal_Paid_EquityClass">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_ClosingInvestedAmount_EquityClass" >
              return Math.Max(OpeningInvestedAmount - AllocationAmount,0);
            </Query>
            <Presentation/>
          </main>
      </Methods>
    </Tool>
    <Tool Name="BaseReserveAccount">
      <Actions>
        <Action ActionCode="OpeningBalance_Base_Reserve_Account" ActionDisplayName="基础储备账户初始余额" FunctionName="RunManagedMethodByPath" SequenceNo="50">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningBalance_Base_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_Base_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Reserve_Due_Base_Reserve_Account" ActionDisplayName="基础储备账户应储备额度" FunctionName="RunManagedMethodByPath" SequenceNo="51">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Reserve_Due_Base_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Reserve_Due_Base_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Reserve_Paid_Base_Reserve_Account" ActionDisplayName="基础储备账户实储备额度" FunctionName="RunManagedMethodByPath" SequenceNo="52">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Reserve_Paid_Base_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Reserve_Paid_Base_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="TopUpAmount" ActionDisplayName="循环购买金额" FunctionName="RunManagedMethodByPath" SequenceNo="53">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_TopUpAmount" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="TopUpAmount" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="TopUpTerm" ActionDisplayName="循环购买资产期长" FunctionName="RunManagedMethodByPath" SequenceNo="53">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_TopUpTerm" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="TopUpTerm" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="TopUpRate" ActionDisplayName="循环购买资产利率" FunctionName="RunManagedMethodByPath" SequenceNo="53">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_TopUpRate" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="TopUpRate" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Due_Base_Reserve_Account" ActionDisplayName="基础储备账户应付金额" FunctionName="RunManagedMethodByPath" SequenceNo="53">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Due_Base_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Due_Base_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Paid_Base_Reserve_Account" ActionDisplayName="基础储备账户实付金额" FunctionName="RunManagedMethodByPath" SequenceNo="54">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Paid_Base_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Paid_Base_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="ClosingBalance_Base_Reserve_Account" ActionDisplayName="基础储备账户结束余额" FunctionName="RunManagedMethodByPath" SequenceNo="55">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingBalance_Base_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_Base_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
      </Actions>
      <Methods>
          <main>
            <Parameters>
              <Parameter Name="Pre_ClosingBalance_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_Base_Reserve_Account">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_OpeningBalance_Base_Reserve_Account" >
              if (CurrentPosition == 0)
              {
              return 0.0;
              }
              else
              {
              return Pre_ClosingBalance_Base_Reserve_Account;
              }
            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Pool_Collection" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Pool_Collection">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Reserve_Due_Base_Reserve_Account" >

              return Pool_Collection;

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Reserve_Due_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Due_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Pool_Collection" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Pool_Collection">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="ClosingBalance_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="ClosingBalance_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_Reserve_Paid_Base_Reserve_Account" >
              if (TopUpPeriod == 0 || ((CurrentPosition + 1) % 3 == 0))
              {
              return Pool_Collection - Reserve_Paid_Tax_Reserve_Account - Reserve_Paid_Fee_Reserve_Account - Reserve_Paid_Income_Reserve_Account + ClosingBalance_Tax_Reserve_Account + ClosingBalance_Fee_Reserve_Account;
              }
              else
              {
              return Pool_Collection - Reserve_Paid_Tax_Reserve_Account - Reserve_Paid_Fee_Reserve_Account - Reserve_Paid_Income_Reserve_Account + ClosingBalance_Tax_Reserve_Account;
              }

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="OpeningBalance_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_TopUpAmount" >
              if (TopUpPeriod == 0)
              {
              return 0;
              }
              else
              {
              return (OpeningBalance_Base_Reserve_Account + Reserve_Paid_Base_Reserve_Account) * 0.95;
              }

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
            </Parameters>
            <Query name="EC_TopUpTerm" >

              return 24;

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
            </Parameters>
            <Query name="EC_TopUpRate" >

              return 0.003;

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="OpeningBalance_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="PaymentPeriod" SessionParameterName="PaymentPeriod" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter Name="Reserve_Paid_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="TopUpAmount">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_Due_Base_Reserve_Account" >
              if (TopUpPeriod == 0)
              {
              return OpeningBalance_Base_Reserve_Account + Reserve_Paid_Base_Reserve_Account;
              }
              else
              {
              return TopUpAmount;
              }

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Due_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Due_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="OpeningBalance_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Paid_Base_Reserve_Account" >

              return Math.Min(Due_Base_Reserve_Account, OpeningBalance_Base_Reserve_Account + Reserve_Paid_Base_Reserve_Account);

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Paid_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Paid_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="OpeningBalance_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_ClosingBalance_Base_Reserve_Account" >

              return OpeningBalance_Base_Reserve_Account + Reserve_Paid_Base_Reserve_Account - Paid_Base_Reserve_Account;

            </Query>
            <Presentation />
          </main>
      </Methods>
    </Tool>
    <Tool Name="FeeReserveAccount">
      <Actions>
        <Action ActionCode="Trust_Fees" ActionDisplayName="费用" FunctionName="RunManagedMethodByPath" SequenceNo="20">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Trust_Fees" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Trust_Fees" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="OpeningBalance_Fee_Reserve_Account" ActionDisplayName="费用储备账户初始余额" FunctionName="RunManagedMethodByPath" SequenceNo="30">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningBalance_Fee_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_Fee_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Reserve_Due_Fee_Reserve_Account" ActionDisplayName="费用储备账户应储备额度" FunctionName="RunManagedMethodByPath" SequenceNo="31">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Reserve_Due_Fee_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Reserve_Due_Fee_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Reserve_Paid_Fee_Reserve_Account" ActionDisplayName="费用储备账户实储备额度" FunctionName="RunManagedMethodByPath" SequenceNo="32">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Reserve_Paid_Fee_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Reserve_Paid_Fee_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Due_Fee_Reserve_Account" ActionDisplayName="费用储备账户应付金额" FunctionName="RunManagedMethodByPath" SequenceNo="33">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Due_Fee_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Due_Fee_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Paid_Fee_Reserve_Account" ActionDisplayName="费用储备账户实付金额" FunctionName="RunManagedMethodByPath" SequenceNo="34">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Paid_Fee_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Paid_Fee_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="ClosingBalance_Fee_Reserve_Account" ActionDisplayName="费用储备账户结束余额" FunctionName="RunManagedMethodByPath" SequenceNo="35">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingBalance_Fee_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_Fee_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Outstanding_Fee_Reserve_Account" ActionDisplayName="费用储备账户未付金额" FunctionName="RunManagedMethodByPath" SequenceNo="36">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Outstanding_Fee_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Outstanding_Fee_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
      </Actions>
      <Methods>
          <main>
            <Parameters>
              <Parameter  Name="Pre_TrustFees" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="TrustFees">
                  <Position>Math.Max(0,CurrentPosition-1)</Position>
                </Field>
              </Parameter>
              <Parameter  Name="InitialInvestedAmount_A" SessionParameterName="InitialInvestedAmount_A" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="InitialInvestedAmount_B" SessionParameterName="InitialInvestedAmount_B" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="InitialInvestedAmount_EquityClass" SessionParameterName="InitialInvestedAmount_EquityClass" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="ExchangeListing" SessionParameterName="ExchangeListing" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="AccountingFirm" SessionParameterName="AccountingFirm" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="RatingAgency" SessionParameterName="RatingAgency" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="LawFirm" SessionParameterName="LawFirm" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="Seller" SessionParameterName="Seller" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="FinancialAdvisor" SessionParameterName="RoleArranger" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="AccountProvider" SessionParameterName="AccountProvider" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_TrustFees" >
              double totalInvestedAmount = InitialInvestedAmount_A + InitialInvestedAmount_B + InitialInvestedAmount_EquityClass;
              double totalFees = 0.0;
              if(ExchangeListing &lt; 0.01) totalFees += (totalInvestedAmount * ExchangeListing / 12) * 3;
              else totalFees += ExchangeListing * 3;
              if(AccountingFirm &lt; 0.01) totalFees += (totalInvestedAmount * AccountingFirm / 12) * 3;
              else totalFees += AccountingFirm * 3;
              if(RatingAgency &lt; 0.01) totalFees += (totalInvestedAmount * RatingAgency / 12) * 3;
              else totalFees += RatingAgency * 3;
              if(Seller &lt; 0.01) totalFees += (totalInvestedAmount * Seller / 12) * 3;
              else totalFees += Seller * 3;
              if(FinancialAdvisor &lt; 0.01) totalFees += (totalInvestedAmount * FinancialAdvisor / 12) * 3;
              else totalFees += FinancialAdvisore * 3;
              if(AccountProvider &lt; 0.01) totalFees += (totalInvestedAmount * AccountProvider / 12) * 3;
              else totalFees += AccountProvider * 3;

              if (TopUpPeriod == 0 || (CurrentPosition % 3 == 0))
              {
              return totalFees;
              }
              else
              {
              return totalFees + Pre_TrustFees;
              }

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Pre_ClosingBalance_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_Fee_Reserve_Account">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_OpeningBalance_Fee_Reserve_Account" >
              if (CurrentPosition == 0 || TopUpPeriod == 0 || (CurrentPosition % 3 == 0))
              {
              return 0.0;
              }
              else
              {
              return Pre_ClosingBalance_Fee_Reserve_Account;
              }
            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Pre_Outstanding_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Outstanding_Fee_Reserve_Account">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
              <Parameter Name="TrustFees" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="TrustFees">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter Name="OpeningBalance_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Reserve_Due_Fee_Reserve_Account" >
              if (TopUpPeriod == 0)
              {
              return TrustFees + Pre_Outstanding_Fee_Reserve_Account;
              }
              else if (TopUpPeriod == 1 &amp;&amp; (CurrentPosition % 3 == 0))
              {
              return TrustFees + Pre_Outstanding_Fee_Reserve_Account;
              }
              else
              {
              return Math.Max(0, TrustFees - OpeningBalance_Fee_Reserve_Account);
              }

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Reserve_Due_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Due_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Pool_Collection" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Pool_Collection">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Reserve_Paid_Fee_Reserve_Account" >

              return Math.Min(Reserve_Due_Fee_Reserve_Account, Pool_Collection - Reserve_Paid_Tax_Reserve_Account);

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Pre_Outstanding_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Outstanding_Fee_Reserve_Account">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
              <Parameter Name="Pre_ReservePeriod_Outstanding_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Outstanding_Fee_Reserve_Account">
                  <Position>Math.Max(CurrentPosition-3,0)</Position>
                </Field>
              </Parameter>
              <Parameter Name="TrustFees" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="TrustFees">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_Due_Fee_Reserve_Account" >
              if (TopUpPeriod == 0)
              {
              return TrustFees + Pre_Outstanding_Fee_Reserve_Account;
              }
              else if (TopUpPeriod == 1 &amp;&amp; ((CurrentPosition + 1) % 3 == 0))
              {
              return TrustFees + Pre_ReservePeriod_Outstanding_Fee_Reserve_Account;
              }
              else
              {
              return 0.0;
              }

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Due_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Due_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="OpeningBalance_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Paid_Fee_Reserve_Account" >

              return Math.Min(Due_Fee_Reserve_Account, OpeningBalance_Fee_Reserve_Account + Reserve_Paid_Fee_Reserve_Account);

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Paid_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Paid_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="OpeningBalance_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_ClosingBalance_Fee_Reserve_Account" >

              return Math.Max(0, OpeningBalance_Fee_Reserve_Account + Reserve_Paid_Fee_Reserve_Account - Paid_Fee_Reserve_Account);

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Paid_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Paid_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Due_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Due_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Outstanding_Fee_Reserve_Account" >

              return Due_Fee_Reserve_Account - Paid_Fee_Reserve_Account;

            </Query>
            <Presentation />
          </main>
      </Methods>
    </Tool>
    <Tool Name="IncomeReserveAccount">
      <Actions>
        <Action ActionCode="OpeningBalance_Income_Reserve_Account" ActionDisplayName="收益储备账户初始余额" FunctionName="RunManagedMethodByPath" SequenceNo="40">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningBalance_Income_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_Income_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Reserve_Due_Income_Reserve_Account" ActionDisplayName="收益储备账户应储备额度" FunctionName="RunManagedMethodByPath" SequenceNo="41">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Reserve_Due_Income_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Reserve_Due_Income_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Reserve_Paid_Income_Reserve_Account" ActionDisplayName="收益储备账户实储备额度" FunctionName="RunManagedMethodByPath" SequenceNo="42">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Reserve_Paid_Income_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Reserve_Paid_Income_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Due_Income_Reserve_Account" ActionDisplayName="收益储备账户应付金额" FunctionName="RunManagedMethodByPath" SequenceNo="43">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Due_Income_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Due_Income_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Paid_Income_Reserve_Account" ActionDisplayName="收益储备账户实付金额" FunctionName="RunManagedMethodByPath" SequenceNo="44">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Paid_Income_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Paid_Income_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="ClosingBalance_Income_Reserve_Account" ActionDisplayName="收益储备账户结束余额" FunctionName="RunManagedMethodByPath" SequenceNo="45">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingBalance_Income_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_Income_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
      </Actions>
      <Methods>
          <main>
            <Parameters>
              <Parameter Name="Pre_ClosingBalance_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_Income_Reserve_Account">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_OpeningBalance_Income_Reserve_Account" >
              if (CurrentPosition == 0)
              {
              return 0.0;
              }
              else
              {
              return Pre_ClosingBalance_Income_Reserve_Account;
              }
            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter  Name="InitialInvestedAmountA" SessionParameterName="InitialInvestedAmount_A" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="InitialInvestedAmountB" SessionParameterName="InitialInvestedAmount_B" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter  Name="BaseNoteMarginA" SessionParameterName="BaseNoteMargin_A" Value="" DataType="double" Usage="CashFlow" />
              <Parameter  Name="BaseNoteMarginB" SessionParameterName="BaseNoteMargin_B" Value="" DataType="double" Usage="CashFlow" />
              <Parameter  Name="InterestRate" SessionParameterName="InterestRate" Value="" DataType="double" Usage="CashFlow" />
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter Name="OpeningBalance_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Reserve_Due_Income_Reserve_Account" >
              if (TopUpPeriod == 1)
              {
              return InitialInvestedAmountA * (InterestRate + BaseNoteMarginA) * 3 / 12 + InitialInvestedAmountB * (InterestRate + BaseNoteMarginB) * 3 / 12 - OpeningBalance_Income_Reserve_Account;
              }
              else
              {
              return InitialInvestedAmountA * (InterestRate + BaseNoteMarginA) * 1 / 12 + InitialInvestedAmountB * (InterestRate + BaseNoteMarginB) * 1 / 12 - OpeningBalance_Income_Reserve_Account;
              }

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Reserve_Due_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Due_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Pool_Collection" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Pool_Collection">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Reserve_Paid_Income_Reserve_Account" >

              return Math.Min(Reserve_Due_Income_Reserve_Account, Pool_Collection - Reserve_Paid_Tax_Reserve_Account - Reserve_Paid_Fee_Reserve_Account);

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="OpeningBalance_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
              <Parameter Name="Reserve_Due_Income_Reserve_Account" SessionParameterName="Reserve_Due_Income_Reserve_Account" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_Due_Income_Reserve_Account" >
              if (TopUpPeriod == 0 || (CurrentPosition + 1) % 3 == 0)
              {
              return OpeningBalance_Income_Reserve_Account + Reserve_Paid_Income_Reserve_Account;
              }
              else
              {
              return 0.0;
              }

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Due_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Due_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="OpeningBalance_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Paid_Income_Reserve_Account" >

              return Math.Min(Due_Income_Reserve_Account, OpeningBalance_Income_Reserve_Account + Reserve_Paid_Income_Reserve_Account);

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Paid_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Paid_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="OpeningBalance_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_ClosingBalance_Income_Reserve_Account" >

              return OpeningBalance_Income_Reserve_Account + Reserve_Paid_Income_Reserve_Account - Paid_Income_Reserve_Account;

            </Query>
            <Presentation />
          </main>
      </Methods>
 
    </Tool>
    <Tool Name="TaxReserveAccount">
      <Actions>
        <Action ActionCode="OpeningBalance_Tax_Reserve_Account" ActionDisplayName="税金储备账户初始余额" FunctionName="RunManagedMethodByPath" SequenceNo="10">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningBalance_Tax_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_Tax_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Reserve_Due_Tax_Reserve_Account" ActionDisplayName="税金储备账户应储备额度" FunctionName="RunManagedMethodByPath" SequenceNo="11">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Reserve_Due_Tax_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Reserve_Due_Tax_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Reserve_Paid_Tax_Reserve_Account" ActionDisplayName="税金储备账户实储备额度" FunctionName="RunManagedMethodByPath" SequenceNo="12">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Reserve_Paid_Tax_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Reserve_Paid_Tax_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Due_Tax_Reserve_Account" ActionDisplayName="税金储备账户应付金额" FunctionName="RunManagedMethodByPath" SequenceNo="13">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Due_Tax_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Due_Tax_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Paid_Tax_Reserve_Account" ActionDisplayName="税金储备账户实付金额" FunctionName="RunManagedMethodByPath" SequenceNo="14">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Paid_Tax_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Paid_Tax_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="ClosingBalance_Tax_Reserve_Account" ActionDisplayName="税金储备账户结束余额" FunctionName="RunManagedMethodByPath" SequenceNo="15">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingBalance_Tax_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_Tax_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Outstanding_Tax_Reserve_Account" ActionDisplayName="税金储备账户未付金额" FunctionName="RunManagedMethodByPath" SequenceNo="16">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Outstanding_Tax_Reserve_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Outstanding_Tax_Reserve_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
      </Actions>
      <Methods>
          <main>
            <Parameters>
              <Parameter Name="Pre_ClosingBalance_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_Tax_Reserve_Account">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_OpeningBalance_Tax_Reserve_Account" >
              return 0.0;
            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Pre_Outstanding_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Outstanding_Tax_Reserve_Account">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
              <Parameter Name="OpeningBalance_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Due_Tax_Reserve_Account" SessionParameterName="Reserve_Due_Tax" Value="100" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_Reserve_Due_Tax_Reserve_Account" >

              return Reserve_Due_Tax_Reserve_Account + Pre_Outstanding_Tax_Reserve_Account - OpeningBalance_Tax_Reserve_Account;

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Reserve_Due_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Due_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Pool_Collection" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Pool_Collection">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Reserve_Paid_Tax_Reserve_Account" >

              return Math.Min(Reserve_Due_Tax_Reserve_Account, Pool_Collection);

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Pre_Outstanding_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Outstanding_Tax_Reserve_Account">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
              <Parameter Name="Due_Tax_Reserve_Account" SessionParameterName="Due_Tax" Value="110" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_Due_Tax_Reserve_Account" >

              return Due_Tax_Reserve_Account + Pre_Outstanding_Tax_Reserve_Account;

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Due_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Due_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="OpeningBalance_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Paid_Tax_Reserve_Account" >

              return Math.Min(Due_Tax_Reserve_Account, OpeningBalance_Tax_Reserve_Account + Reserve_Paid_Tax_Reserve_Account);

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Paid_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Paid_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Reserve_Paid_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Reserve_Paid_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="OpeningBalance_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_ClosingBalance_Tax_Reserve_Account" >

              return Math.Max(0, OpeningBalance_Tax_Reserve_Account + Reserve_Paid_Tax_Reserve_Account - Paid_Tax_Reserve_Account);

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Paid_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Paid_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Due_Tax_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Due_Tax_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Outstanding_Tax_Reserve_Account" >

              return Due_Tax_Reserve_Account - Paid_Tax_Reserve_Account;

            </Query>
            <Presentation />
          </main>
      </Methods>
     
    </Tool>
    <Tool Name="TrustPlanAccount">
      <Actions>
        <Action ActionCode="OpeningBalance_TrustPlan_Account" ActionDisplayName="专项计划账户初始余额" FunctionName="RunManagedMethodByPath" SequenceNo="60">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_OpeningBalance_TrustPlan_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="OpeningBalance_TrustPlan_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Transferred_TrustPlan_Account" ActionDisplayName="专项计划账户划拨金额" FunctionName="RunManagedMethodByPath" SequenceNo="61">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Transferred_TrustPlan_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Transferred_TrustPlan_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="ClosingBalance_TrustPlan_Account" ActionDisplayName="专项计划账户剩余金额" FunctionName="RunManagedMethodByPath" SequenceNo="62">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_ClosingBalance_TrustPlan_Account" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="ClosingBalance_TrustPlan_Account" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
        <Action ActionCode="Income_TotalAvailable" ActionDisplayName="资产池可分配收入" FunctionName="RunManagedMethodByPath" SequenceNo="70">
          <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
          <Parameter Name="AssemblyPath" SessionParameterName="" Value="C:\\Temp\\CashFlowEquationScript.dll" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="MethodName" SessionParameterName="" Value="EC_Income_TotalAvailable" DataType="String" Usage="Task" IsConfigurable="false" />
          <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
          <Parameter Name="CashFlowName" SessionParameterName="" Value="Income_TotalAvailable" DataType="String" Usage="" IsConfigurable="false" />
        </Action>
      </Actions>
      <Methods>
          <main>
            <Parameters>
              <Parameter Name="Pre_ClosingBalance_TrustPlan_Account_AfterAllocation" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_TrustPlan_Account_AfterAllocation">
                  <Position>Math.Max(CurrentPosition-1,0)</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_OpeningBalance_TrustPlan_Account" >
              if (CurrentPosition == 0)
              {
              return 0.0;
              }
              else
              {
              return Pre_ClosingBalance_TrustPlan_Account_AfterAllocation;
              }
            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="Paid_Income_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Paid_Income_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="ClosingBalance_Fee_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_Fee_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Paid_Base_Reserve_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Paid_Base_Reserve_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="TopUpPeriod" SessionParameterName="TopUpPeriod" Value="" DataType="double" Usage="CashFlow"/>
            </Parameters>
            <Query name="EC_Transferred_TrustPlan_Account" >
              if (TopUpPeriod == 0)
              {
              return Paid_Income_Reserve_Account + ClosingBalance_Fee_Reserve_Account + Paid_Base_Reserve_Account;
              }
              else if ((CurrentPosition + 1) % 3 == 0)
              {
              return Paid_Income_Reserve_Account + ClosingBalance_Fee_Reserve_Account;
              }
              else
              {
              return Paid_Income_Reserve_Account;
              }

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="OpeningBalance_TrustPlan_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="OpeningBalance_TrustPlan_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Transferred_TrustPlan_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Transferred_TrustPlan_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_ClosingBalance_TrustPlan_Account" >

              return OpeningBalance_TrustPlan_Account + Transferred_TrustPlan_Account;

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter Name="ClosingBalance_TrustPlan_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_TrustPlan_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Interest_Paid_A" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Interest_Paid_A">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Interest_Paid_B" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Interest_Paid_B">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Principal_Paid_A" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Principal_Paid_A">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Principal_Paid_B" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Principal_Paid_B">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
              <Parameter Name="Principal_Paid_EquityClass" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="Principal_Paid_EquityClass">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_ClosingBalance_TrustPlan_Account_AfterAllocation" >

              return ClosingBalance_TrustPlan_Account - Interest_Paid_A - Interest_Paid_B - Principal_Paid_A - Principal_Paid_B - Principal_Paid_EquityClass;

            </Query>
            <Presentation />
          </main>
          <main>
            <Parameters>
              <Parameter  Name="ClosingBalance_TrustPlan_Account" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
                <Field Name="ClosingBalance_TrustPlan_Account">
                  <Position>CurrentPosition</Position>
                </Field>
              </Parameter>
            </Parameters>
            <Query name="EC_Income_TotalAvailable" >

              return ClosingBalance_TrustPlan_Account;

            </Query>
            <Presentation />
          </main>
      </Methods>
    </Tool>
  </Tools>
</Task>