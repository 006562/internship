<Tool Name="CashFlowFeeTopUpModel">
  <Actions>
    <Action ActionCode="TrustPlanAccount_Principal_OpeningBalance" ActionDisplayName="专项计划本金账户初始余额" FunctionName="RunManagedMethodByPath" SequenceNo="1">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_TrustPlanAccount_Principal_OpeningBalance" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_Principal_OpeningBalance" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TrustPlanAccount_Interest_OpeningBalance" ActionDisplayName="专项计划收入账户初始余额" FunctionName="RunManagedMethodByPath" SequenceNo="2">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_TrustPlanAccount_Interest_OpeningBalance" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_Interest_OpeningBalance" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TrustPlanAccount_OpeningBalance" ActionDisplayName="专项计划账户初始余额" FunctionName="RunManagedMethodByPath" SequenceNo="3">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_TrustPlanAccount_OpeningBalance" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_OpeningBalance" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TrustPlanAccount_Principal_Collected" ActionDisplayName="专项计划账户本金收入" FunctionName="RunManagedMethodByPath" SequenceNo="4">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" IsDirectInput="true"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_Principal_Collected" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TrustPlanAccount_Interest_Collected" ActionDisplayName="专项计划账户利息收入" FunctionName="RunManagedMethodByPath" SequenceNo="5">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" IsDirectInput="true"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_Interest_Collected" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TrustPlanAccount_Total_Collected" ActionDisplayName="专项计划账户总收入" FunctionName="RunManagedMethodByPath" SequenceNo="6">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" IsDirectInput="true"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_Total_Collected" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="InterestDays" ActionDisplayName="计息天数" FunctionName="RunManagedMethodByPath" SequenceNo="7">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="InterestDays" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TopUpPeriod" ActionDisplayName="循环期" FunctionName="RunManagedMethodByPath" SequenceNo="8">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TopUpPeriod" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="CollectionTimeDistribution" ActionDisplayName="循环购买回收期分布" FunctionName="RunManagedMethodByPath" SequenceNo="9">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="CollectionTimeDistribution" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TopUp_Collected" ActionDisplayName="循环购买资产回收款" FunctionName="RunManagedMethodByPath" SequenceNo="14">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="false" DataType="String" Usage="CashFlow" IsConfigurable="true" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="AddIn.CashflowScript.GenericBondWaterfallPlus" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="CalculateTopUp" DataType="String" Usage="Task" IsConfigurable="true" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TopUp_Collected" DataType="String" Usage="" IsConfigurable="true" />
    </Action>
    <Action ActionCode="TopUpPercentage" ActionDisplayName="循环购买占比" FunctionName="RunManagedMethodByPath" SequenceNo="11">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TopUpPercentage" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TopUpAmount" ActionDisplayName="循环购买金额" FunctionName="RunManagedMethodByPath" SequenceNo="12">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="true"/>
      <Parameter Name="NumberFormat" SessionParameterName="" Value="{0:#,0.00}" DataType="String" Usage="CashFlow" IsConfigurable="true"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_TopUpAmount" DataType="String" Usage="Task" IsConfigurable="true"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TopUpAmount" DataType="String" Usage="" IsConfigurable="true"/>
    </Action>
    <Action ActionCode="TaxAccount_Fee" ActionDisplayName="税" FunctionName="RunManagedMethodByPath" SequenceNo="13">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TaxAccount_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TrusteeAccount_Fee" ActionDisplayName="托管费" FunctionName="RunManagedMethodByPath" SequenceNo="14">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrusteeAccount_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="ScrutinyAccount_Fee" ActionDisplayName="监管费" FunctionName="RunManagedMethodByPath" SequenceNo="15">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="ScrutinyAccount_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="Registration_Fee" ActionDisplayName="登记费" FunctionName="RunManagedMethodByPath" SequenceNo="16">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="Registration_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="Agent_Fee" ActionDisplayName="中介费用" FunctionName="RunManagedMethodByPath" SequenceNo="17">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="Agent_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="LoanService_Fee" ActionDisplayName="贷款服务报酬" FunctionName="RunManagedMethodByPath" SequenceNo="18">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="LoanService_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="RatingAgency_Fee" ActionDisplayName="评级费用" FunctionName="RunManagedMethodByPath" SequenceNo="19">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="RatingAgency_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="Auditor_Fee" ActionDisplayName="审计费用" FunctionName="RunManagedMethodByPath" SequenceNo="20">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="Auditor_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="LawFirm_Fee" ActionDisplayName="律师事务所费率" FunctionName="RunManagedMethodByPath" SequenceNo="21">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="LawFirm_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="AccoutingFirm_Fee" ActionDisplayName="会计师事务所费率" FunctionName="RunManagedMethodByPath" SequenceNo="22">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="AccoutingFirm_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="Other_Fee" ActionDisplayName="其他费用" FunctionName="RunManagedMethodByPath" SequenceNo="23">
      <Parameter Name="IsDirectInput" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="Other_Fee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="Expenses_Paid" ActionDisplayName="费用支出" FunctionName="RunManagedMethodByPath" SequenceNo="24">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_Expenses_Paid" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="Expenses_Paid" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="ChinaBondFee" ActionDisplayName="中登手续费" FunctionName="RunManagedMethodByPath" SequenceNo="25">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_ChinaBondFee" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="ChinaBondFee" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TrustPlanAccount_Total_AvailableAmt" ActionDisplayName="专项计划账户可分配金额" FunctionName="RunManagedMethodByPath" SequenceNo="26">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_TrustPlanAccount_Total_AvailableAmt" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_Total_AvailableAmt" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TrustPlanAccount_Principal_AvailableAmt" ActionDisplayName="专项计划账户可分配本金" FunctionName="RunManagedMethodByPath" SequenceNo="27">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_TrustPlanAccount_Principal_AvailableAmt" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_Principal_AvailableAmt" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
    <Action ActionCode="TrustPlanAccount_Interest_AvailableAmt" ActionDisplayName="专项计划账户可分配利息" FunctionName="RunManagedMethodByPath" SequenceNo="28">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false"/>
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_TrustPlanAccount_Interest_AvailableAmt" DataType="String" Usage="Task" IsConfigurable="false"/>
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false"/>
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_Interest_AvailableAmt" DataType="String" Usage="" IsConfigurable="false"/>
    </Action>
  </Actions>
  <Methods>
    <main>
      <Parameters>
        <Parameter Name="Pre_TrustPlanAccount_Principal_ClosingBalance" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Principal_ClosingBalance">
            <Position>Math.Max(CurrentPosition-1,0)</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TrustPlanAccount_Principal_OpeningBalance">
        if (CurrentPosition == 0)
        {
        return 0.0;
        }
        else
        {
        return Pre_TrustPlanAccount_Principal_ClosingBalance;
        }
      </Query>
      <Presentation/>
    </main>
    <main>
      <Parameters>
        <Parameter Name="Pre_TrustPlanAccount_Interest_ClosingBalance" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Interest_ClosingBalance">
            <Position>Math.Max(CurrentPosition-1,0)</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TrustPlanAccount_Interest_OpeningBalance">
        if (CurrentPosition == 0)
        {
        return 0.0;
        }
        else
        {
        return Pre_TrustPlanAccount_Interest_ClosingBalance;
        }
      </Query>
      <Presentation/>
    </main>
    <main>
      <Parameters>
        <Parameter Name="Pre_TrustPlanAccount_ClosingBalance" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_ClosingBalance">
            <Position>Math.Max(CurrentPosition-1,0)</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TrustPlanAccount_OpeningBalance">
        if (CurrentPosition == 0)
        {
        return 0.0;
        }
        else
        {
        return Pre_TrustPlanAccount_ClosingBalance;
        }
      </Query>
      <Presentation/>
    </main>
    <main>
      <Parameters>
        <Parameter Name="TopUpPeriod" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TopUpPeriod">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TopUpPercentage" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TopUpPercentage">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TrustPlanAccount_Total_Collected" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Total_Collected">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TopUp_Collected" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TopUp_Collected">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TopUpAmount">
        if (TopUpPeriod==1)
        {
        return (TrustPlanAccount_Total_Collected+TopUp_Collected)*TopUpPercentage;
        }
        else
        {
        return 0;
        };
      </Query>
      <Presentation></Presentation>
    </main>
    <main>
      <Parameters>
        <Parameter Name="TaxAccount_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TaxAccount_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TrusteeAccount_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrusteeAccount_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="ScrutinyAccount_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="ScrutinyAccount_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="Registration_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="Registration_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="Agent_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="Agent_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="LoanService_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="LoanService_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="RatingAgency_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="RatingAgency_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="Auditor_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="Auditor_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="LawFirm_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="LawFirm_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="AccoutingFirm_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="AccoutingFirm_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="Other_Fee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="Other_Fee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_Expenses_Paid">
        return TaxAccount_Fee + TrusteeAccount_Fee + ScrutinyAccount_Fee + Registration_Fee + Agent_Fee + LoanService_Fee + RatingAgency_Fee + Auditor_Fee + LawFirm_Fee + AccoutingFirm_Fee + Other_Fee;
      </Query>
      <Presentation/>
    </main>
    <main>
      <Parameters>
        <Parameter Name="Principal_Collected" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Principal_Collected">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="Interest_Collected" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Interest_Collected">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TrustPlanAccount_Principal_OpeningBalance" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Principal_OpeningBalance">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TrustPlanAccount_Interest_OpeningBalance" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Interest_OpeningBalance">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="Expenses_Paid" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="Expenses_Paid">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TopUp_Collected" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TopUp_Collected">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TopUpAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TopUpAmount">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_ChinaBondFee">
        return Math.Round((Principal_Collected + Interest_Collected +TopUp_Collected + TrustPlanAccount_Principal_OpeningBalance + TrustPlanAccount_Interest_OpeningBalance - TopUpAmount - Expenses_Paid)*0.00005/(1.00005),7);
      </Query>
      <Presentation></Presentation>
    </main>
    <main>
      <Parameters>
        <Parameter Name="Total_Collected" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Total_Collected">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="Principal_Collected" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Principal_Collected">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="Interest_Collected" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Interest_Collected">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TrustPlanAccount_Principal_OpeningBalance" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Principal_OpeningBalance">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TrustPlanAccount_Interest_OpeningBalance" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Interest_OpeningBalance">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="Expenses_Paid" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="Expenses_Paid">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="ChinaBondFee" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="ChinaBondFee">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TopUpAmount" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TopUpAmount">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TopUp_Collected" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TopUp_Collected">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TrustPlanAccount_Total_AvailableAmt">
        if ( (Principal_Collected + Interest_Collected) == 0)
        {
        return Total_Collected + TrustPlanAccount_Principal_OpeningBalance + TrustPlanAccount_Interest_OpeningBalance + TopUp_Collected-TopUpAmount- Expenses_Paid - ChinaBondFee ;
        }
        else
        {
        return Principal_Collected + Interest_Collected + TrustPlanAccount_Principal_OpeningBalance + TrustPlanAccount_Interest_OpeningBalance + TopUp_Collected- TopUpAmount- Expenses_Paid - ChinaBondFee;
        }
      </Query>
      <Presentation></Presentation>
    </main>
    <main>
      <Parameters>
        <Parameter Name="TrustPlanAccount_Total_AvailableAmt" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Total_AvailableAmt">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="Principal_Collected" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Principal_Collected">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TrustPlanAccount_Principal_OpeningBalance" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Principal_OpeningBalance">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TrustPlanAccount_Principal_AvailableAmt">
        return Math.Min(TrustPlanAccount_Total_AvailableAmt,Principal_Collected+TrustPlanAccount_Principal_OpeningBalance);
      </Query>
      <Presentation/>
    </main>
    <main>
      <Parameters>
        <Parameter Name="TrustPlanAccount_Total_AvailableAmt" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Total_AvailableAmt">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TrustPlanAccount_Principal_AvailableAmt" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Principal_AvailableAmt">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TrustPlanAccount_Interest_AvailableAmt">
        return Math.Max(0,TrustPlanAccount_Total_AvailableAmt - TrustPlanAccount_Principal_AvailableAmt);
      </Query>
      <Presentation></Presentation>
    </main>
  </Methods>
</Tool>