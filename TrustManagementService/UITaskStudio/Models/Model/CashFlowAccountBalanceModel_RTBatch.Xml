
<Tool Name="CashFlowAccountBalanceModel">
  <Actions>
    <Action ActionCode="TrustPlanAccount_Principal_ClosingBalance" ActionDisplayName="本金分账户期末余额" FunctionName="RunManagedMethodByPath" SequenceNo="100">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_TrustPlanAccount_Principal_ClosingBalance" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_Principal_ClosingBalance" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
    <Action ActionCode="TrustPlanAccount_Interest_ClosingBalance" ActionDisplayName="收入分账户期末余额" FunctionName="RunManagedMethodByPath" SequenceNo="101">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_TrustPlanAccount_Interest_ClosingBalance" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_Interest_ClosingBalance" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
    <Action ActionCode="TrustPlanAccount_ClosingBalance" ActionDisplayName="信托账户期末余额" FunctionName="RunManagedMethodByPath" SequenceNo="102">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_TrustPlanAccount_ClosingBalance" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="TrustPlanAccount_ClosingBalance" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
    <Action ActionCode="Cashflow_Total" ActionDisplayName="总现金流" FunctionName="RunManagedMethodByPath" SequenceNo="103">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_Cashflow_Total" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="Cashflow_Total" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
    <Action ActionCode="Cashflow_Retained" ActionDisplayName="留存现金流" FunctionName="RunManagedMethodByPath" SequenceNo="104">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_Cashflow_Retained" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="Cashflow_Retained" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
    <Action ActionCode="Cashflow_Outgoing" ActionDisplayName="转出现金流" FunctionName="RunManagedMethodByPath" SequenceNo="105">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_Cashflow_Outgoing" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="Cashflow_Outgoing" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
    <Action ActionCode="DiscountDays" ActionDisplayName="折现天数" FunctionName="RunManagedMethodByPath" SequenceNo="106">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_DiscountDays" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="DiscountDays" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
    <Action ActionCode="DiscountRate" ActionDisplayName="贴现除数（按期实际）" FunctionName="RunManagedMethodByPath" SequenceNo="107">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_DiscountRate" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="DiscountRate" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
    <Action ActionCode="DiscountedCashlfow_Total" ActionDisplayName="证券总现金流（贴现值）" FunctionName="RunManagedMethodByPath" SequenceNo="108">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_DiscountedCashlfow_Total" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="DiscountedCashlfow_Total" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
    <Action ActionCode="DiscountedCashlfow_Outgoing" ActionDisplayName="转出现金流（贴现值）" FunctionName="RunManagedMethodByPath" SequenceNo="109">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_DiscountedCashlfow_Outgoing" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="DiscountedCashlfow_Outgoing" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
    <Action ActionCode="DiscountedCashlfow_Retained" ActionDisplayName="留存现金流（贴现值）" FunctionName="RunManagedMethodByPath" SequenceNo="110">
      <Parameter Name="IsCashFlowDisplay" SessionParameterName="" Value="true" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="InputType" SessionParameterName="" Value="Calculated" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="ActionType" SessionParameterName="" Value="CashFlow" DataType="String" Usage="CashFlow" IsConfigurable="false" />
      <Parameter Name="AssemblyPath" SessionParameterName="" Value="" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="TypeName" SessionParameterName="" Value="EquationProvider.CashFlowEquationProvider" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="MethodName" SessionParameterName="" Value="EC_DiscountedCashlfow_Retained" DataType="String" Usage="Task" IsConfigurable="false" />
      <Parameter Name="CurrentPosition" SessionParameterName="CurrentPosition" Value="0" DataType="Int16" Usage="" IsConfigurable="false" />
      <Parameter Name="CashFlowName" SessionParameterName="" Value="DiscountedCashlfow_Retained" DataType="String" Usage="" IsConfigurable="false" />
    </Action>
   </Actions>
  <Methods>
     <main>
      <Parameters>
        <Parameter Name="TrustPlanAccount_Principal_AvailableAmt" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Principal_AvailableAmt">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TrustPlanAccount_Principal_ClosingBalance">
        return TrustPlanAccount_Principal_AvailableAmt ;
      </Query>
      <Presentation />
    </main>
      <main>
      <Parameters>
        <Parameter Name="TrustPlanAccount_Interest_AvailableAmt" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Interest_AvailableAmt">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TrustPlanAccount_Interest_ClosingBalance">
        return TrustPlanAccount_Interest_AvailableAmt;
      </Query>
      <Presentation />
    </main>
	 <main>
      <Parameters>
        <Parameter Name="TrustPlanAccount_Principal_ClosingBalance" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Principal_ClosingBalance">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
        <Parameter Name="TrustPlanAccount_Interest_ClosingBalance" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlanAccount_Interest_ClosingBalance">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TrustPlanAccount_ClosingBalance">
        return TrustPlanAccount_Principal_ClosingBalance + TrustPlanAccount_Interest_ClosingBalance;
      </Query>
      <Presentation />
    </main>
    <main>
      <Parameters>
        <Parameter Name="TrustPlan_Total_AllocationAmt" SessionParameterName="" Value="" DataType="double" Usage="CashFlow">
          <Field Name="TrustPlan_Total_AllocationAmt">
            <Position>CurrentPosition</Position>
          </Field>
        </Parameter>
      </Parameters>
      <Query name="EC_TrustPlanAccount_ClosingBalance">
        return TrustPlan_Total_AllocationAmt;
      </Query>
      <Presentation />
    </main>
    <main>
      <Parameters>
        <Parameter Name="RetainPercentage_A" SessionParameterName="RetainPercentage_A" Value="" DataType="double" Usage="CashFlow" ></Parameter>
        <Parameter Name="RetainPercentage_B" SessionParameterName="RetainPercentage_B" Value="" DataType="double" Usage="CashFlow" ></Parameter>
        <Parameter Name="RetainPercentage_C" SessionParameterName="RetainPercentage_C" Value="" DataType="double" Usage="CashFlow" ></Parameter>
        <Parameter Name="RetainPercentage_D" SessionParameterName="RetainPercentage_D" Value="" DataType="double" Usage="CashFlow" ></Parameter>
        <Parameter Name="TotalBondPayment_A" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="TotalBondPayment_A"><Position>CurrentPosition</Position></Field></Parameter>
        <Parameter Name="TotalBondPayment_B" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="TotalBondPayment_B"><Position>CurrentPosition</Position></Field></Parameter>
        <Parameter Name="TotalBondPayment_C" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="TotalBondPayment_C"><Position>CurrentPosition</Position></Field></Parameter>
        <Parameter Name="TotalBondPayment_EquityClass" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="TotalBondPayment_EquityClass"><Position>CurrentPosition</Position></Field></Parameter>
      </Parameters>
      <Query name="EC_Cashflow_Retained">
			  return TotalBondPayment_A * RetainPercentage_A + TotalBondPayment_B * RetainPercentage_B + TotalBondPayment_C * RetainPercentage_C + TotalBondPayment_EquityClass * RetainPercentage_D;		
      </Query>
      <Presentation/>
    </main>
    <main>
      <Parameters>
        <Parameter Name="Cashflow_Total" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="Cashflow_Total"><Position>CurrentPosition</Position></Field></Parameter>
        <Parameter Name="Cashflow_Retained" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="Cashflow_Retained"><Position>CurrentPosition</Position></Field></Parameter>
      </Parameters>
      <Query name="EC_Cashflow_Outgoing">
        return Cashflow_Total - Cashflow_Retained;
      </Query>
      <Presentation/>
    </main>
    <main>
      <Parameters>
        <Parameter Name="Cashflow_Total" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="Cashflow_Total"><Position>CurrentPosition</Position></Field></Parameter>
        <Parameter Name="DiscountRate" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="DiscountRate"><Position>CurrentPosition</Position></Field></Parameter>
      </Parameters>
      <Query name="EC_DiscountedCashlfow_Total">
        return Cashflow_Total / DiscountRate;
      </Query>
      <Presentation/>
    </main>
    <main>
      <Parameters>
        <Parameter Name="Cashflow_Outgoing" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="Cashflow_Outgoing"><Position>CurrentPosition</Position></Field></Parameter>
        <Parameter Name="DiscountRate" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="DiscountRate"><Position>CurrentPosition</Position></Field></Parameter>
      </Parameters>
      <Query name="EC_DiscountedCashlfow_Outgoing">
        return Cashflow_Outgoing / DiscountRate;
      </Query>
      <Presentation/>
    </main>
    <main>
      <Parameters>
        <Parameter Name="Cashflow_Retained" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="Cashflow_Retained"><Position>CurrentPosition</Position></Field></Parameter>
        <Parameter Name="DiscountRate" SessionParameterName="" Value="" DataType="double" Usage="CashFlow" ><Field Name="DiscountRate"><Position>CurrentPosition</Position></Field></Parameter>
      </Parameters>
      <Query name="EC_DiscountedCashlfow_Retained">
        return Cashflow_Retained / DiscountRate;
      </Query>
      <Presentation/>
    </main>
    </Methods>
</Tool>
